# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–º–ø–∞–º–∏ Neo4j

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–∞–º–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Neo4j –≤ –ø—Ä–æ–µ–∫—Ç–µ.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-–¥–∞–º–ø–∞)
- [–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–º–ø–∞](#–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ-–¥–∞–º–ø–∞)
- [–§–æ—Ä–º–∞—Ç—ã –¥–∞–º–ø–æ–≤](#—Ñ–æ—Ä–º–∞—Ç—ã-–¥–∞–º–ø–æ–≤)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

## üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞

### –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (PowerShell)

```powershell
# –°–æ–∑–¥–∞—Ç—å –¥–∞–º–ø –≤–æ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
.\export_neo4j_dump.ps1

# –°–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ Cypher –¥–∞–º–ø
.\export_neo4j_dump.ps1 -Format cypher

# –£–∫–∞–∑–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
.\export_neo4j_dump.ps1 -OutputDir C:\backups
```

### –†—É—á–Ω–æ–π —Å–ø–æ—Å–æ–± (Python)

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
venv\Scripts\activate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞
python scripts\export_neo4j_dump.py
```

### –ß–µ—Ä–µ–∑ Docker (cypher-shell)

```bash
# –≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ cypher-shell
docker exec -it radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j "MATCH (n) RETURN n" > dump.cypher

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π –¥–∞–º–ø
docker exec -it radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j "CALL apoc.export.cypher.all('dump.cypher', {})"
```

## üì• –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–º–ø–∞

### –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (PowerShell)

```powershell
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ Cypher —Ñ–∞–π–ª–∞
.\import_neo4j_dump.ps1 -DumpFile dumps\neo4j_dump_20241203_143022.cypher

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –æ—á–∏—Å—Ç–∫–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
.\import_neo4j_dump.ps1 -DumpFile dumps\neo4j_dump_20241203_143022.cypher -Clear

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
.\import_neo4j_dump.ps1 -DumpFile dumps\neo4j_dump_20241203_143022.cypher -Verify
```

### –†—É—á–Ω–æ–π —Å–ø–æ—Å–æ–± (Python)

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
venv\Scripts\activate

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ Cypher —Ñ–∞–π–ª–∞
python scripts\import_neo4j_dump.py dumps\neo4j_dump_20241203_143022.cypher

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –æ—á–∏—Å—Ç–∫–æ–π
python scripts\import_neo4j_dump.py dumps\neo4j_dump_20241203_143022.cypher --clear

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
python scripts\import_neo4j_dump.py dumps\neo4j_dump_20241203_143022.cypher --verify
```

### –ß–µ—Ä–µ–∑ Docker (cypher-shell)

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ Cypher —Ñ–∞–π–ª–∞
docker exec -i radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j < dumps\neo4j_dump_20241203_143022.cypher

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª
docker cp dumps\neo4j_dump_20241203_143022.cypher radar-neo4j:/tmp/dump.cypher
docker exec -it radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j -f /tmp/dump.cypher
```

## üìÅ –§–æ—Ä–º–∞—Ç—ã –¥–∞–º–ø–æ–≤

### 1. Cypher (.cypher)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∫—Ä–∏–ø—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ CREATE/MERGE
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –õ–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è, –º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –ú–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º –¥–ª—è –±–æ–ª—å—à–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –º–∏–≥—Ä–∞—Ü–∏–∏

### 2. JSON (.json)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –õ–µ–≥–∫–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 3. CSV (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —É–∑–ª–æ–≤ –∏ —Å–≤—è–∑–µ–π
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –õ–µ–≥–∫–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –¢–µ—Ä—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, —ç–∫—Å–ø–æ—Ä—Ç –≤ –¥—Ä—É–≥–∏–µ –ë–î

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

```powershell
# 1. –°–æ–∑–¥–∞—Ç—å –¥–∞–º–ø
.\export_neo4j_dump.ps1 -OutputDir backups\before_changes

# 2. –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# ... –≤–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è ...

# 3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
.\import_neo4j_dump.ps1 -DumpFile backups\before_changes\neo4j_dump_*.cypher -Clear
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

```powershell
# –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
.\export_neo4j_dump.ps1 -OutputDir migration\prod_dump

# –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
.\import_neo4j_dump.ps1 -DumpFile migration\prod_dump\neo4j_dump_*.cypher -Clear -Verify
```

### –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

```powershell
# –°–æ–∑–¥–∞—Ç—å CSV –¥–∞–º–ø –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
.\export_neo4j_dump.ps1 -Format csv -OutputDir analysis

# –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã –≤ Excel –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
# analysis\neo4j_dump_*\nodes_*.csv
# analysis\neo4j_dump_*\relationships_*.csv
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Neo4j –Ω–µ –∑–∞–ø—É—â–µ–Ω

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å Neo4j
docker-compose up -d neo4j

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker ps --filter "name=radar-neo4j"
```

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
Get-Content .env | Select-String "NEO4J"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤
netstat -an | Select-String "7474|7687"
```

### –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞

```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Neo4j
docker logs radar-neo4j

# –û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é
docker exec -it radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j "MATCH (n) DETACH DELETE n"
```

### –ë–æ–ª—å—à–∏–µ –¥–∞–º–ø—ã

```powershell
# –î–ª—è –±–æ–ª—å—à–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cypher-shell –Ω–∞–ø—Ä—è–º—É—é
docker exec -it radar-neo4j cypher-shell -u neo4j -p password123 -d neo4j "CALL apoc.export.cypher.all('large_dump.cypher', {})"

# –ò–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ —á–∞—Å—Ç—è–º
python scripts\export_neo4j_dump.py  # –¢–æ–ª—å–∫–æ —É–∑–ª—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```cypher
// –í Neo4j Browser (http://localhost:7474)
// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–∑–ª–æ–≤
MATCH (n) RETURN labels(n) as node_type, count(n) as count ORDER BY count DESC

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–≤—è–∑–µ–π
MATCH ()-[r]->() RETURN type(r) as relationship_type, count(r) as count ORDER BY count DESC

// –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
CALL db.stats.retrieve('GRAPH COUNTS')
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

```cypher
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–µ–π –±–µ–∑ —É–∑–ª–æ–≤
MATCH (a)-[r]->(b) WHERE a IS NULL OR b IS NULL RETURN count(r)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
MATCH (n) WITH n, count(n) as cnt WHERE cnt > 1 RETURN labels(n), cnt
```

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑–º–µ—Ä –¥–∞–º–ø–æ–≤** - –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—á–∏—Å—Ç–∫—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –¥–∞–º–ø—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ** —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs radar-neo4j`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Neo4j –∑–∞–ø—É—â–µ–Ω: `docker ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `http://localhost:7474`
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Neo4j: https://neo4j.com/docs/
